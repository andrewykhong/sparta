"SPARTA WWW Site"_sws - "SPARTA Documentation"_sd - "SPARTA Commands"_sc :c

:link(sws,https://sparta.github.io)
:link(sd,Manual.html)
:link(sc,Section_commands.html#comm)

:line

custom command :h3

[Syntax:]

custom style action args ... action args ... :pre

style = {particle} or {grid} or {surf} :ulb,l
action = {create} or {remove} or {set} or {file} :l
  {create} args = cname datatype Nc
    cname = name of custom vector or array to create and initialize with zeroes
    datatype = {int} or {float} = for integer or floating point values
    Nc = 0 for a vector (single value), Nc >= 1 for an array (one or more values)
  {remove} arg2 = cname
    cname = name of custom vector or array to remove
  {set} args = cname v_name subset-ID region-ID
    cname = specify as name (no brackets) for custom vector with name
            or as name\[N\] for Nth column of custom array with name
    v_name = equal-, particle-, grid-, or surf-style variable with name
    subset-ID = mixture ID (particles) or group ID (grid cells or surf elements)
    region-ID = only apply to particle/grid/surf in region, NULL to not test
  {file} args = fname M cname1 cname2 ... cnameM
    fname = name of file with custom attributes for grid cells or surf elements
    M = # of custom values listed on each line of the file
    cname1,cname2,...,cnameM = which attribute each line value in the file is assigned to
      cnameI = name of a custom vector
      cnameI = name\[N\] for Nth column of a custom array with name :pre
:ule

[Examples:]

variable ivec particle id/100000
variable sdvec surf c_1*10+3.5
variable sdarray1 surf s_dvec+1
variable sdarray2 surf v_sdarray1+1 :pre

custom particle create ivec int 0 set ivec v_ivec air NULL
custom surf create sdvec float 0 set sdvec v_sdvec all NULL
custom surf create darray float 2 set darray\[1\] v_sdarray1 all NULL
custom surf set darray\[2\] v_sdarray2 all NULL
custom grid create gvec int 0 create garray float 2 file grid.attributes gvec garray[1] garray[2]
custom particle remove ivec
custom surf remove darray :pre

[Description:]

Create or remove or initialize/reset custom attributes for particles,
grid cells, or surface elements.

To create a new attribute, the {create} action is specified.  To
remove an attribute, the {remove} action is specified.  The {set}
action evaluates a variable to reset the values for an attribute.  The
{file} action reads a file with lines starting with a grid cell ID or
surface element ID followed by values for one or more per-grid or
per-surf attributes.  Particle-style attributes cannot be reset with
the {file} action.

Custom attributes can be vectors (single value per entity) or arrays
(mutiple values per entity).  They can also be integer or floating
point values.  See "Section 6.17"_Section_howto.html#howto_17 for an
explanation of custom attributes.

The {style} setting is {particle} or {grid} or {surf} for custom
per-particle, per-grid, or per-surf attributes.

The {action} setting is {create} or {remove} or {set} or {file}.

The {create} action creates a new custom attribute called {cname} and
initializes all its values to zero.  The {datatype} is specified as
{int} or {float} and determines what kind of values the attribute
stores.  {Nc} is specified as 0 for custom vector which stores a
single value per entity.  Specify {Nc} >= 1 for a custom array which
stores Nc values per entity.

The {remove} action deletes the custom attribute called {cname},
whether it is a vector or array.

The {set} and {file} actions reset the values of custom attribute(s)
which must already exist.

:line

The {set} action resets the values of a custom attribute by evaluating
a variable.  To operate on a custom vector, {cname} is simply the name
of the vector.  To operate on a single column of a custom array,
{cname} is specified as name\[N\] for the Nth column of a custom array
with name.

The specified {v_name} is the name of the variable which is evaluated.
It must be either an equal-style or particle-style or grid-style or
surf-style variable.  All of these define a mathematical formula which
is used to compute the value(s) of the variable.  See the
"variable"_variable.html command for details.

If an equal-style variable is specified, it produces a single value
which will be assigned as the custom value to all the particles or
grid cells or surface elements (see subset-ID and region-ID discussion
below).  Otherwise a particle-style variable must be used for {style
particle}, a grid-style variable for {style grid}, or a surf-style
variable for {style surf}.  When it is evaluated it generates one
value for each particle, grid cell, or surface element, which is
assigned to the custom vector or to a column of the custom array.

Note that the latter 3 variable styles can include outputs from
"compute"_compute.html or "fix"_fix.html commands.  They can also
include the current timestep (as can equal-style variables) or the
spatial position of a particle, grid cell, or surface element in their
formula.  So it is easy to calculate a value for each entity which
varies in time or spatially.

The next two arguments, {subset-ID} and {region-ID}, can limit which
particles, grid cells, or surface elements are assigned a custom
value.  An individual particle, grid cell, or surface element must
meet both criteria to have its custom value set, otherwise its value
is unchanged.

The {subset-ID} is the ID of a mixture for particles or the ID of a
group of grid cells or surface elements.  Only particles in the
mixture or grid cells/surface elements in the group will be assigned a
value.  See the "mixture"_mixture.html and "group"_group.html commands
for more details.  Note that "all" is a pre-defined mixture ID which
contains all particles.  Likewise "all" is the name of a pre-defined
group with all grid cells or all surface elements.

The {region-ID} is the ID of a geometric region defined by the
"region"_region.html command.  Only particles or grid cells or surface
elements in the region will have their values set.  The center point
of a grid cell or surface element is used for the region check.  If
{region-ID} is specified as NULL, then the region criterion is not
applied.

:line

The {file} action resets the values of one or more custom attributes
by reading them from the {fname} file.  It can only be used with
{style grid} or {style surf}, not with {style particle}.

The number of {cname1,cname2,...,cnameM} arguments must match the
number of values listed on each line in the file.  A {cnameI} with no
brackets is the name of a custom vector.  For a custom array, {cnameI}
must be of the form name\[N\] for the Nth column of the array.

The format of the file is as follows.  Note that the number of
attributes specified in the file does not have to equal the number of
grid cells or surface elements.  If the ID of a grid cell or surface
element does not appear in the file, then its custom attribute
value(s) will be unchanged.

The file can start with any number of commented or blank lines.
A commented line starts with the "#" character.

The first non-comment, non-blank line must be an integer count N of
the number of remaining attribute value lines in the file.  These N
lines must immediately follow the count line and contain no blank lines.
Any remaining lines are ignored.

The format of each attribute value line is as follows:

ID value1 value2 ... valueM

ID is the integer ID of the grid cell or surface element.  Note that
for hierarchial grids, it must be the integer form of the ID, not the
string form.  M values follow, corresponding to the {M} argument in the
input script, following the {fname} argument.

The following is an example of a correctly formatted file to set the
values for a per-surface custom array with 2 columns.  Only the
values for 3 surface elements are set.

# custom values for a few surface elements
# calculated for test problem XYZ :pre

3
1 10.0 5.0
20 12.0 6.5
21 8.0 4.55 :pre

This file could be read with an input script command like this:

custom surf create darray float 2 file file.surf 2 darray\[1\] darray\[2\] :pre

:line

[Restrictions:] none

[Related commands:]

"fix custom"_fix_custom.html, "mixture"_mixture.html,
"group"_group.html, "region"_region.html

[Default:] none
